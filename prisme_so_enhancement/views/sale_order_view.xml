<?xml version="1.0"?>
<!-- 
###########################################################################
#
#    Prisme Solutions Informatique SA
#    Copyright (c) 2020 Prisme Solutions Informatique SA <http://prisme.ch>
#
#    This program is free software: you can redistribute it and/or modify
#    it under the terms of the GNU Affero General Public License as
#    published by the Free Software Foundation, either version 3 of the
#    License, or (at your option) any later version.
#    This program is distributed in the hope that it will be useful,
#    but WITHOUT ANY WARRANTY; without even the implied warranty of
#    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
#    GNU Affero General Public License for more details.
#    You should have received a copy of the GNU Affero General Public Lic
#    along with this program.  If not, see <http://www.gnu.org/licenses/>.
#
#    Project ID:    OERP-003-03 - T503
#
##########################################################################
 -->
<odoo>
	<data>
		<record model="ir.ui.view" id="sale_order_form_sale_prisme">
			<field name="name">sale.order.form.sale.layout.prisme</field>
			<field name="model">sale.order</field>
			<field name="inherit_id" ref="sale.view_order_form" />
			<field name="type">form</field>
			<field name="priority">35</field>
			<field name="arch" type="xml">
				<field name="pricelist_id" position="after">
					<field name="rounding_on_subtotal" />
				</field>				
				<xpath
					expr="//div[@name='lead']"
					position="after">
						<field name="date_delivery" />
				</xpath>

				<xpath expr="/form/sheet/notebook/page/field/form/div"
					position="after">
					<group>
						<separator colspan="2" string="Refusal" />
						<field name="refused" />
						<field name="refusal_reason" />
					</group>

					<group>
						<separator colspan="2" string="State" />
						<field name="state" />
					</group>
				</xpath>
				
				<xpath
					expr="//field[@name='order_line']/form//div[@name='discount']"
					position="after">
					<field name="discount_amount" groups="product.group_discount_per_so_line"/>
				</xpath>
				
				<xpath
					expr="/form/sheet/notebook/page[1]/field/tree/field[@name='discount']"
					position="after">
					<field name="discount_amount" groups="product.group_discount_per_so_line" optional="show" string="Disc. (amount)"/>
				</xpath>


				<xpath expr="/form/sheet/notebook/page[@name='other_information']/group[last()]"
					position="after">
					<group>

						<field name="create_date" />
						<field name="confirmation_date" />
					</group>
					<group>
						<separator string="Quotation Validity" colspan="2" />
						<field name="quotation_comment" />
					</group>
					<group>
						<separator colspan="4" string="Notes" />
						<field colspan="4" name="note" nolabel="1" />
					</group>
					<group>
						<separator colspan="4" string="Cancellation" />
						<field colspan="4" name="cancellation_reason" />
					</group>
				</xpath>

			</field>
		</record>


		<record model="ir.ui.view" id="sale_order_tree_prisme">
			<field name="name">sale.order.tree.prisme</field>
			<field name="model">sale.order</field>
			<field name="inherit_id" ref="sale.view_order_tree" />
			<field name="type">tree</field>
			<field name="arch" type="xml">
				<field name="partner_id" position="before">
					<field name="client_order_ref" />
				</field>
			</field>
		</record>


		<record model="ir.ui.view" id="quotation_tree_prisme">
			<field name="name">quotation.tree.prisme</field>
			<field name="model">sale.order</field>
			<field name="inherit_id" ref="sale.view_quotation_tree" />
			<field name="type">tree</field>
			<field name="arch" type="xml">
				<field name="partner_id" position="before">
					<field name="client_order_ref" />
				</field>
				<field name="user_id" position="replace">
				</field>
			</field>
		</record>

		<record model="ir.ui.view"
			id="sale_order_form_editable_list_prisme">
			<field name="name">sale.order.form.editable.list.prisme</field>
			<field name="model">sale.order</field>
			<field name="inherit_id" ref="sale.view_order_form" />
			<field name="priority">5</field>
			<field name="type">form</field>
			<field name="arch" type="xml">
				<xpath expr="//field[@name='order_line']/tree"
					position="attributes">
					<attribute name="editable" />
				</xpath>
			</field>
		</record>

		<record model="ir.ui.view"
			id="sale_order_form_refused_list_prisme">
			<field name="name">sale.order.form.refused.list.prisme</field>
			<field name="model">sale.order</field>
			<field name="inherit_id" ref="sale.view_order_form" />
			<field name="priority">30</field>
			<field name="type">form</field>
			<field name="arch" type="xml">
				<xpath
					expr="/form/sheet/notebook/page/field[@name='order_line']/tree/field[@name='price_subtotal']"
					position="after">
					<field name="refused" />
				</xpath>
			</field>
		</record>
	</data>

</odoo>
